<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Modules Documentation &mdash; AnnDictionary 0.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
    <link rel="canonical" href="https://ggit12.github.io/anndictionary/docs/modules.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=10f1778b"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to AnnDictionary’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            AnnDictionary
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Modules Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.AdataDict"><code class="docutils literal notranslate"><span class="pre">AdataDict</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#anndict.dict.AdataDict.fapply"><code class="docutils literal notranslate"><span class="pre">AdataDict.fapply()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.apply_func"><code class="docutils literal notranslate"><span class="pre">apply_func()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.adata_dict_fapply"><code class="docutils literal notranslate"><span class="pre">adata_dict_fapply()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.apply_func_return"><code class="docutils literal notranslate"><span class="pre">apply_func_return()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.adata_dict_fapply_return"><code class="docutils literal notranslate"><span class="pre">adata_dict_fapply_return()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.check_and_create_strata"><code class="docutils literal notranslate"><span class="pre">check_and_create_strata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.read_adata_dict"><code class="docutils literal notranslate"><span class="pre">read_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.build_adata_dict"><code class="docutils literal notranslate"><span class="pre">build_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.build_adata_dict_main"><code class="docutils literal notranslate"><span class="pre">build_adata_dict_main()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.subsplit_adata_dict"><code class="docutils literal notranslate"><span class="pre">subsplit_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.concatenate_adata_dict"><code class="docutils literal notranslate"><span class="pre">concatenate_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.summarize_metadata_adata_dict"><code class="docutils literal notranslate"><span class="pre">summarize_metadata_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.display_html_summary_adata_dict"><code class="docutils literal notranslate"><span class="pre">display_html_summary_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.set_var_index"><code class="docutils literal notranslate"><span class="pre">set_var_index()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.set_obs_index"><code class="docutils literal notranslate"><span class="pre">set_obs_index()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.remove_genes"><code class="docutils literal notranslate"><span class="pre">remove_genes()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.remove_genes_adata_dict"><code class="docutils literal notranslate"><span class="pre">remove_genes_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.subsample_adata_dict"><code class="docutils literal notranslate"><span class="pre">subsample_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.resample_adata"><code class="docutils literal notranslate"><span class="pre">resample_adata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.resample_adata_dict"><code class="docutils literal notranslate"><span class="pre">resample_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.normalize_adata_dict"><code class="docutils literal notranslate"><span class="pre">normalize_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.log_transform_adata_dict"><code class="docutils literal notranslate"><span class="pre">log_transform_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.set_high_variance_genes_adata_dict"><code class="docutils literal notranslate"><span class="pre">set_high_variance_genes_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.rank_genes_groups_adata_dict"><code class="docutils literal notranslate"><span class="pre">rank_genes_groups_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.scale_adata_dict"><code class="docutils literal notranslate"><span class="pre">scale_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.pca_adata_dict"><code class="docutils literal notranslate"><span class="pre">pca_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.neighbors_adata_dict"><code class="docutils literal notranslate"><span class="pre">neighbors_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.leiden_adata_dict"><code class="docutils literal notranslate"><span class="pre">leiden_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.leiden_sub_cluster"><code class="docutils literal notranslate"><span class="pre">leiden_sub_cluster()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.leiden_sub_cluster_adata_dict"><code class="docutils literal notranslate"><span class="pre">leiden_sub_cluster_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.calculate_umap_adata_dict"><code class="docutils literal notranslate"><span class="pre">calculate_umap_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.plot_umap_adata_dict"><code class="docutils literal notranslate"><span class="pre">plot_umap_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.write_h5ad_adata_dict"><code class="docutils literal notranslate"><span class="pre">write_h5ad_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.stable_label_adata_dict"><code class="docutils literal notranslate"><span class="pre">stable_label_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.predict_labels_adata_dict"><code class="docutils literal notranslate"><span class="pre">predict_labels_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.update_adata_labels_with_stable_label_results_dict"><code class="docutils literal notranslate"><span class="pre">update_adata_labels_with_stable_label_results_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.update_adata_labels_with_predictions_dict"><code class="docutils literal notranslate"><span class="pre">update_adata_labels_with_predictions_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.update_adata_dict_with_label_dict"><code class="docutils literal notranslate"><span class="pre">update_adata_dict_with_label_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.plot_changes_adata_dict"><code class="docutils literal notranslate"><span class="pre">plot_changes_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.plot_confusion_matrix_adata_dict"><code class="docutils literal notranslate"><span class="pre">plot_confusion_matrix_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.harmony_label_transfer_adata_dict"><code class="docutils literal notranslate"><span class="pre">harmony_label_transfer_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_determine_leiden_resolution"><code class="docutils literal notranslate"><span class="pre">ai_determine_leiden_resolution()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_determine_leiden_resolution_adata_dict"><code class="docutils literal notranslate"><span class="pre">ai_determine_leiden_resolution_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.simplify_obs_column"><code class="docutils literal notranslate"><span class="pre">simplify_obs_column()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.simplify_obs_column_adata_dict"><code class="docutils literal notranslate"><span class="pre">simplify_obs_column_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.create_label_hierarchy"><code class="docutils literal notranslate"><span class="pre">create_label_hierarchy()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.create_label_hierarchy_adata_dict"><code class="docutils literal notranslate"><span class="pre">create_label_hierarchy_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.simplify_var_index"><code class="docutils literal notranslate"><span class="pre">simplify_var_index()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.simplify_var_index_adata_dict"><code class="docutils literal notranslate"><span class="pre">simplify_var_index_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_annotate_cell_type"><code class="docutils literal notranslate"><span class="pre">ai_annotate_cell_type()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_annotate_cell_type_adata_dict"><code class="docutils literal notranslate"><span class="pre">ai_annotate_cell_type_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_annotate_cell_sub_type_adata_dict"><code class="docutils literal notranslate"><span class="pre">ai_annotate_cell_sub_type_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_annotate_cell_sub_type"><code class="docutils literal notranslate"><span class="pre">ai_annotate_cell_sub_type()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_annotate_cell_type_by_comparison_adata_dict"><code class="docutils literal notranslate"><span class="pre">ai_annotate_cell_type_by_comparison_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_annotate_cell_type_by_comparison"><code class="docutils literal notranslate"><span class="pre">ai_annotate_cell_type_by_comparison()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_annotate_biological_process"><code class="docutils literal notranslate"><span class="pre">ai_annotate_biological_process()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_annotate_biological_process_adata_dict"><code class="docutils literal notranslate"><span class="pre">ai_annotate_biological_process_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_annotate_by_comparison"><code class="docutils literal notranslate"><span class="pre">ai_annotate_by_comparison()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_annotate"><code class="docutils literal notranslate"><span class="pre">ai_annotate()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_unify_labels"><code class="docutils literal notranslate"><span class="pre">ai_unify_labels()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ensure_label_consistency_adata_dict"><code class="docutils literal notranslate"><span class="pre">ensure_label_consistency_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ensure_label_consistency_adata"><code class="docutils literal notranslate"><span class="pre">ensure_label_consistency_adata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ensure_label_consistency_main"><code class="docutils literal notranslate"><span class="pre">ensure_label_consistency_main()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.create_label_df"><code class="docutils literal notranslate"><span class="pre">create_label_df()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_compare_cell_type_labels_pairwise"><code class="docutils literal notranslate"><span class="pre">ai_compare_cell_type_labels_pairwise()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.ai_compare_cell_type_labels_pairwise_adata_dict"><code class="docutils literal notranslate"><span class="pre">ai_compare_cell_type_labels_pairwise_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.plot_sankey_adata_dict"><code class="docutils literal notranslate"><span class="pre">plot_sankey_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.save_sankey_adata_dict"><code class="docutils literal notranslate"><span class="pre">save_sankey_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.dict.plot_grouped_average_adata_dict"><code class="docutils literal notranslate"><span class="pre">plot_grouped_average_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.strata.preprocess_adata_strata"><code class="docutils literal notranslate"><span class="pre">preprocess_adata_strata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.strata.stable_label_adata_strata"><code class="docutils literal notranslate"><span class="pre">stable_label_adata_strata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.strata.plot_confusion_matrix_across_strata"><code class="docutils literal notranslate"><span class="pre">plot_confusion_matrix_across_strata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.utils.make_names"><code class="docutils literal notranslate"><span class="pre">make_names()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.utils.normalize_string"><code class="docutils literal notranslate"><span class="pre">normalize_string()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.utils.normalize_label"><code class="docutils literal notranslate"><span class="pre">normalize_label()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.utils.add_label_to_adata"><code class="docutils literal notranslate"><span class="pre">add_label_to_adata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.utils.add_col_to_adata_obs"><code class="docutils literal notranslate"><span class="pre">add_col_to_adata_obs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.utils.add_col_to_adata_var"><code class="docutils literal notranslate"><span class="pre">add_col_to_adata_var()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.utils.convert_obs_col_to_category"><code class="docutils literal notranslate"><span class="pre">convert_obs_col_to_category()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.utils.convert_obs_col_to_string"><code class="docutils literal notranslate"><span class="pre">convert_obs_col_to_string()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.utils.convert_obs_index_to_str"><code class="docutils literal notranslate"><span class="pre">convert_obs_index_to_str()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.utils.get_adata_columns"><code class="docutils literal notranslate"><span class="pre">get_adata_columns()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.utils.create_color_map"><code class="docutils literal notranslate"><span class="pre">create_color_map()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.utils.UCE_adata"><code class="docutils literal notranslate"><span class="pre">UCE_adata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.bedrock_init"><code class="docutils literal notranslate"><span class="pre">bedrock_init()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.azureml_init"><code class="docutils literal notranslate"><span class="pre">azureml_init()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.google_genai_init"><code class="docutils literal notranslate"><span class="pre">google_genai_init()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.default_init"><code class="docutils literal notranslate"><span class="pre">default_init()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.configure_llm_backend"><code class="docutils literal notranslate"><span class="pre">configure_llm_backend()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.get_llm_config"><code class="docutils literal notranslate"><span class="pre">get_llm_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.get_llm"><code class="docutils literal notranslate"><span class="pre">get_llm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.call_llm"><code class="docutils literal notranslate"><span class="pre">call_llm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.retry_llm_call"><code class="docutils literal notranslate"><span class="pre">retry_llm_call()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.enforce_semantic_list"><code class="docutils literal notranslate"><span class="pre">enforce_semantic_list()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.extract_dictionary_from_ai_string"><code class="docutils literal notranslate"><span class="pre">extract_dictionary_from_ai_string()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.attempt_ai_integration"><code class="docutils literal notranslate"><span class="pre">attempt_ai_integration()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.generate_file_key"><code class="docutils literal notranslate"><span class="pre">generate_file_key()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.process_llm_category_mapping"><code class="docutils literal notranslate"><span class="pre">process_llm_category_mapping()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.map_cell_type_labels_to_simplified_set"><code class="docutils literal notranslate"><span class="pre">map_cell_type_labels_to_simplified_set()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.map_gene_labels_to_simplified_set"><code class="docutils literal notranslate"><span class="pre">map_gene_labels_to_simplified_set()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.ai_biological_process"><code class="docutils literal notranslate"><span class="pre">ai_biological_process()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.ai_cell_type"><code class="docutils literal notranslate"><span class="pre">ai_cell_type()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.ai_cell_types_by_comparison"><code class="docutils literal notranslate"><span class="pre">ai_cell_types_by_comparison()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.ai_compare_cell_types_binary"><code class="docutils literal notranslate"><span class="pre">ai_compare_cell_types_binary()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.ai_compare_cell_types_categorical"><code class="docutils literal notranslate"><span class="pre">ai_compare_cell_types_categorical()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.encode_plot_for_openai"><code class="docutils literal notranslate"><span class="pre">encode_plot_for_openai()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.ai_resolution_interpretation"><code class="docutils literal notranslate"><span class="pre">ai_resolution_interpretation()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.ai.determine_sign_of_resolution_change"><code class="docutils literal notranslate"><span class="pre">determine_sign_of_resolution_change()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.metadata_summary.summarize_metadata"><code class="docutils literal notranslate"><span class="pre">summarize_metadata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.metadata_summary.display_html_summary"><code class="docutils literal notranslate"><span class="pre">display_html_summary()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.get_slurm_cores"><code class="docutils literal notranslate"><span class="pre">get_slurm_cores()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.pca_density_filter"><code class="docutils literal notranslate"><span class="pre">pca_density_filter()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.pca_density_wrapper"><code class="docutils literal notranslate"><span class="pre">pca_density_wrapper()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.pca_density_adata_dict"><code class="docutils literal notranslate"><span class="pre">pca_density_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.stable_label"><code class="docutils literal notranslate"><span class="pre">stable_label()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.stable_label_adata"><code class="docutils literal notranslate"><span class="pre">stable_label_adata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.update_adata_labels_with_results"><code class="docutils literal notranslate"><span class="pre">update_adata_labels_with_results()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.plot_training_history"><code class="docutils literal notranslate"><span class="pre">plot_training_history()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.plot_changes"><code class="docutils literal notranslate"><span class="pre">plot_changes()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.plot_confusion_matrix_from_adata"><code class="docutils literal notranslate"><span class="pre">plot_confusion_matrix_from_adata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.plot_confusion_matrix"><code class="docutils literal notranslate"><span class="pre">plot_confusion_matrix()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.plot_sankey"><code class="docutils literal notranslate"><span class="pre">plot_sankey()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.save_sankey"><code class="docutils literal notranslate"><span class="pre">save_sankey()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.plot_grouped_average"><code class="docutils literal notranslate"><span class="pre">plot_grouped_average()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.plot_model_agreement"><code class="docutils literal notranslate"><span class="pre">plot_model_agreement()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.kappa_adata"><code class="docutils literal notranslate"><span class="pre">kappa_adata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.krippendorff_alpha_adata"><code class="docutils literal notranslate"><span class="pre">krippendorff_alpha_adata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.stablelabel.harmony_label_transfer"><code class="docutils literal notranslate"><span class="pre">harmony_label_transfer()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.spatial_dict.read_data"><code class="docutils literal notranslate"><span class="pre">read_data()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.spatial_dict.get_steps_and_coords"><code class="docutils literal notranslate"><span class="pre">get_steps_and_coords()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.spatial_dict.populate_sparse_array"><code class="docutils literal notranslate"><span class="pre">populate_sparse_array()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.spatial_dict.process_gene_counts"><code class="docutils literal notranslate"><span class="pre">process_gene_counts()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.spatial_dict.create_anndata"><code class="docutils literal notranslate"><span class="pre">create_anndata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.spatial_dict.add_blank_image_to_adata"><code class="docutils literal notranslate"><span class="pre">add_blank_image_to_adata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.spatial_dict.build_adata_from_transcript_positions"><code class="docutils literal notranslate"><span class="pre">build_adata_from_transcript_positions()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.spatial_dict.build_adata_from_visium"><code class="docutils literal notranslate"><span class="pre">build_adata_from_visium()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.spatial_dict.plot_spatial_adata_dict"><code class="docutils literal notranslate"><span class="pre">plot_spatial_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.spatial_dict.compute_spatial_neighbors_adata_dict"><code class="docutils literal notranslate"><span class="pre">compute_spatial_neighbors_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.spatial_dict.perform_colocalization_adata_dict"><code class="docutils literal notranslate"><span class="pre">perform_colocalization_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.spatial_dict.plot_colocalization_adata_dict"><code class="docutils literal notranslate"><span class="pre">plot_colocalization_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.spatial_dict.compute_interaction_matrix_adata_dict"><code class="docutils literal notranslate"><span class="pre">compute_interaction_matrix_adata_dict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#anndict.spatial_dict.plot_interaction_matrix_adata_dict"><code class="docutils literal notranslate"><span class="pre">plot_interaction_matrix_adata_dict()</span></code></a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AnnDictionary</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Modules Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/modules.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-anndict.dict">
<span id="modules-documentation"></span><h1>Modules Documentation<a class="headerlink" href="#module-anndict.dict" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="anndict.dict.AdataDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">AdataDict</span></span><a class="reference internal" href="_modules/anndict/dict.html#AdataDict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.AdataDict" title="Link to this definition"></a></dt>
<dd><p>AdataDict is a dictionary-like container where values are AnnData objects.</p>
<p>This class provides two main functionalities:
1. It behaves like an AnnData object by passing each method through to each AnnData in the dictionary. For example, adata_dict.obs.group_by(“column”) will apply the group_by method on the obs attribute of each AnnData object in the dictionary.
2. It has a method fapply(func, kwargs) that applies a given function func with arguments kwargs to each AnnData object in the dictionary.</p>
<p>Methods:
__getattr__(attr) Dynamically creates methods that apply the corresponding method of AnnData objects in the dictionary.</p>
<p>fapply(func, kwargs) Applies the provided function func with additional arguments kwargs to each AnnData object in the dictionary.</p>
<p>Attributes:
Inherits attributes from the built-in dict class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="anndict.dict.AdataDict.fapply">
<span class="sig-name descname"><span class="pre">fapply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#AdataDict.fapply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.AdataDict.fapply" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.apply_func">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">apply_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adt_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepts_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_retries</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">func_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#apply_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.apply_func" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.adata_dict_fapply">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">adata_dict_fapply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_multithreading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs_dicts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#adata_dict_fapply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.adata_dict_fapply" title="Link to this definition"></a></dt>
<dd><p>Applies a given function to each AnnData object in the adata_dict, with error handling,
retry mechanism, and the option to use either threading or sequential execution.</p>
<p>Parameters:
- adata_dict: Dictionary of AnnData objects with keys as identifiers.
- func: Function to apply to each AnnData object in the dictionary.
- use_multithreading: If True, use ThreadPoolExecutor; if False, execute sequentially.
- num_workers: Number of worker threads to use (default: number of CPUs available).
- max_retries: Maximum number of retries for a failed task.
- kwargs_dicts: Additional keyword arguments to pass to the function.</p>
<p>Returns:
- None: The function modifies the AnnData objects in place.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.apply_func_return">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">apply_func_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adt_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepts_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_retries</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">func_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#apply_func_return"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.apply_func_return" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.adata_dict_fapply_return">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">adata_dict_fapply_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_multithreading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs_dicts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#adata_dict_fapply_return"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.adata_dict_fapply_return" title="Link to this definition"></a></dt>
<dd><p>Applies a given function to each AnnData object in the adata_dict, with error handling,
retry mechanism, and the option to use either threading or sequential execution. Returns
a dictionary with the results of the function applied to each AnnData object.</p>
<p>Parameters:
- adata_dict: Dictionary of AnnData objects with keys as identifiers.
- func: Function to apply to each AnnData object in the dictionary.
- use_multithreading: If True, use ThreadPoolExecutor; if False, execute sequentially.
- num_workers: Number of worker threads to use (default: number of CPUs available).
- max_retries: Maximum number of retries for a failed task.
- kwargs_dicts: Additional keyword arguments to pass to the function.</p>
<p>Returns:
- dict: A dictionary with the same keys as adata_dict, containing the results of the function applied to each AnnData object.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.check_and_create_strata">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">check_and_create_strata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strata_keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#check_and_create_strata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.check_and_create_strata" title="Link to this definition"></a></dt>
<dd><p>Checks if the specified stratifying variables are present in the AnnData object,
and creates a new column combining these variables if it does not already exist.</p>
<p>Parameters:
adata : (AnnData) An AnnData object.
strata_keys : (list of str) List of keys (column names) in adata.obs to be used for stratification.</p>
<p>Returns:
str: (str) The name of the newly created or verified existing combined strata column.</p>
<p>Raises:
ValueError: If one or more of the specified stratifying variables do not exist in adata.obs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.read_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">read_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#read_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.read_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Reads .h5ad files from a list of paths and returns them in a dictionary.
For each element in the provided list of paths, if the element is a directory,
it reads all .h5ad files in that directory. If the element is an .h5ad file,
it reads the file directly. The results are returned as a dictionary with
keys generated by generate_file_key() or fallback to “ad1”, “ad2”, … if
generate_file_key() fails, or uses provided keys if given.</p>
<p>Parameters:
paths (list): A list of paths to directories or .h5ad files.
keys (list, optional): A list of strings to use as keys for the adata_dict. If provided, must be equal in length to the number of .h5ad files read.</p>
<p>Returns:
dict: A dictionary with keys as specified or generated, and values as AnnData objects.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.build_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">build_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strata_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_strata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#build_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.build_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Build a dictionary of AnnData objects split by desired strata values.</p>
<p>Parameters:
adata (AnnData): Annotated data matrix.
strata_keys (list of str): List of column names in <cite>adata.obs</cite> to use for stratification.
desired_strata (list or dict, optional): List of desired strata values or a dictionary where keys are strata keys and values are lists of desired strata values. If None (Default), all combinations of categories in adata.obs[strata_keys] will be used.
Returns:
dict: Dictionary where keys are strata values and values are corresponding AnnData subsets.</p>
<p>Raises:
ValueError: If <cite>desired_strata</cite> is neither a list nor a dictionary of lists.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.build_adata_dict_main">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">build_adata_dict_main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strata_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_strata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_missing_strata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#build_adata_dict_main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.build_adata_dict_main" title="Link to this definition"></a></dt>
<dd><p>Main function to build a dictionary of AnnData objects based on desired strata values.</p>
<p>Parameters:
adata (AnnData): Annotated data matrix.
strata_keys (list of str): List of column names in <cite>adata.obs</cite> to use for stratification.
desired_strata (list of str): List of desired strata values.</p>
<p>Returns:
dict: Dictionary where keys are strata values and values are corresponding AnnData subsets.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.subsplit_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">subsplit_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strata_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_strata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#subsplit_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.subsplit_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Split each value of an AnnData dictionary into further subsets based on additional desired strata.</p>
<p>Parameters:
adata_dict (dict): Dictionary where keys are strata values and values are AnnData objects.
strata_keys (list of str): List of column names in <cite>adata.obs</cite> to use for further stratification.
desired_strata (list or dict): List of desired strata values or a dictionary where keys are strata keys and values are lists of desired strata values.</p>
<p>Returns:
dict: Nested dictionary of AnnData objects split by the additional desired strata.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.concatenate_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">concatenate_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#concatenate_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.concatenate_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Concatenates all AnnData objects in adata_dict into a single AnnData object.
If only a single AnnData object is present, returns it as is.</p>
<p>Parameters:
- adata_dict (dict): Dictionary of AnnData objects with keys as identifiers.
- kwargs: Additional keyword arguments for concatenation.</p>
<p>Returns:
- AnnData: A single AnnData object or the original AnnData object if only one is provided.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.summarize_metadata_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">summarize_metadata_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#summarize_metadata_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.summarize_metadata_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Generate summary tables for each AnnData object in the dictionary using the summarize_metadata function.</p>
<p>Parameters:
- adata_dict (dict): Dictionary of AnnData objects with keys as identifiers.
- kwargs: Additional keyword arguments, including ‘columns’ which specifies a list of columns from the metadata to summarize. Use ‘*’ to specify joint frequencies of multiple columns.</p>
<p>Returns:
- dict: A dictionary of summary dictionaries for each AnnData object in the adata_dict.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.display_html_summary_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">display_html_summary_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summary_dict_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#display_html_summary_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.display_html_summary_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Display separate HTML tables for each metadata category in the summary dictionaries,
arranging up to three tables in a row before starting a new line.</p>
<p>Parameters:
- summary_dict_dict (dict): A dictionary of summary dictionaries for each AnnData object in the adata_dict.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.set_var_index">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">set_var_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#set_var_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.set_var_index" title="Link to this definition"></a></dt>
<dd><p>Set the index of adata.var to the specified column for each AnnData object in adata_dict.</p>
<p>Parameters:
adata_dict (dict): A dictionary where keys are identifiers and values are AnnData objects.
column (str): The column name to set as the index of adata.var.</p>
<p>Returns:
dict: A dictionary with the same structure as adata_dict, where the var attribute of each AnnData object has its index set to the specified column.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.set_obs_index">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">set_obs_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#set_obs_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.set_obs_index" title="Link to this definition"></a></dt>
<dd><p>Set the index of adata.obs to the specified column for each AnnData object in adata_dict.</p>
<p>Parameters:
adata_dict (dict): A dictionary where keys are identifiers and values are AnnData objects.
column (str): The column name to set as the index of adata.obs.</p>
<p>Returns:
dict: A dictionary with the same structure as adata_dict, where the obs attribute of each AnnData object has its index set to the specified column.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.remove_genes">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">remove_genes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genes_to_remove</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adt_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#remove_genes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.remove_genes" title="Link to this definition"></a></dt>
<dd><p>Remove specified genes from an AnnData object in-place.</p>
<p>Parameters:
adata (anndata.AnnData): The AnnData object to modify.
genes_to_remove (list): A list of gene names to remove.</p>
<p>Returns:
None</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.remove_genes_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">remove_genes_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genes_to_remove</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#remove_genes_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.remove_genes_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Remove specified genes from each AnnData object in adata_dict.</p>
<p>Parameters:
adata_dict : dict A dictionary where keys are identifiers and values are AnnData objects.
genes_to_remove : list A list of gene names to remove from each AnnData object.</p>
<p>Returns:
None</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.subsample_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">subsample_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#subsample_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.subsample_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Subsamples each AnnData object in the dictionary using Scanpy’s subsample function.</p>
<p>Parameters:
- adata_dict (dict): Dictionary of AnnData objects with keys as identifiers.
- kwargs: Additional keyword arguments to pass to the subsample function.</p>
<p>Returns:
- None: The function modifies the input AnnData objects in place.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.resample_adata">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">resample_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strata_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_num_cells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_largest_groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#resample_adata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.resample_adata" title="Link to this definition"></a></dt>
<dd><p>Resample an AnnData object based on specified strata keys and drop strata with fewer than the minimum number of cells.</p>
<p>Parameters:
adata (AnnData): Annotated data matrix.
strata_keys (list of str): List of column names in adata.obs to use for stratification.
min_num_cells (int): Minimum number of cells required to retain a stratum.
kwargs: Additional keyword arguments to pass to the subsample function.</p>
<p>Returns:
AnnData: Concatenated AnnData object after resampling and filtering.</p>
<p>Raises:
ValueError: If any of the specified strata_keys do not exist in adata.obs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.resample_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">resample_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strata_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_largest_groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_num_cells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#resample_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.resample_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Resample each AnnData object in a dictionary based on specified strata keys and drop strata with fewer than the minimum number of cells.</p>
<p>Parameters:
adata_dict (dict): Dictionary where keys are strata values and values are AnnData objects.
strata_keys (list of str): List of column names in adata.obs to use for stratification.
min_num_cells (int, optional): Minimum number of cells required to retain a stratum. Default is 0.
kwargs: Additional keyword arguments to pass to the resample function.</p>
<p>Returns:
dict: Dictionary of resampled AnnData objects after filtering.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.normalize_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">normalize_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#normalize_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.normalize_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Normalizes each AnnData object in the dictionary using Scanpy’s normalize_total.</p>
<p>Parameters:
- adata_dict (dict): Dictionary of AnnData objects with keys as identifiers.
- kwargs: Additional keyword arguments to pass to the normalize_total function.</p>
<p>Returns:
- None: The function modifies the input AnnData objects in place.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.log_transform_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">log_transform_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#log_transform_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.log_transform_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Log-transforms each AnnData object in the dictionary using Scanpy’s log1p.</p>
<p>Parameters:
- adata_dict (dict): Dictionary of AnnData objects with keys as identifiers.
- kwargs: Additional keyword arguments to pass to the log1p function.</p>
<p>Returns:
- None: The function modifies the input AnnData objects in place.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.set_high_variance_genes_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">set_high_variance_genes_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#set_high_variance_genes_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.set_high_variance_genes_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Identifies high-variance genes in each AnnData object in the dictionary.</p>
<p>Parameters:
- adata_dict (dict): Dictionary of AnnData objects with keys as identifiers.
- kwargs: Additional keyword arguments to pass to the highly_variable_genes function.</p>
<p>Returns:
- None: The function modifies the input AnnData objects in place.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.rank_genes_groups_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">rank_genes_groups_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#rank_genes_groups_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.rank_genes_groups_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Identifies differentially expressed genes in each AnnData object in the dictionary.</p>
<p>Parameters:
- adata_dict (dict): Dictionary of AnnData objects with keys as identifiers.
- kwargs: Additional keyword arguments to pass to the rank_genes_groups function.</p>
<p>Returns:
- None: The function modifies the input AnnData objects in place.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.scale_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">scale_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#scale_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.scale_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Scales each AnnData object in the dictionary using Scanpy’s scale function.</p>
<p>Parameters:
- adata_dict (dict): Dictionary of AnnData objects with keys as identifiers.
- kwargs: Additional keyword arguments to pass to the scale function.</p>
<p>Returns:
- None: The function modifies the input AnnData objects in place.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.pca_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">pca_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#pca_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.pca_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Performs PCA on each AnnData object in the dictionary using Scanpy’s pca function.</p>
<p>Parameters:
- adata_dict (dict): Dictionary of AnnData objects with keys as identifiers.
- kwargs: Additional keyword arguments to pass to the pca function.</p>
<p>Returns:
- None: The function modifies the input AnnData objects in place.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.neighbors_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">neighbors_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#neighbors_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.neighbors_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Calculates neighborhood graph for each AnnData object in the dictionary using Scanpy’s neighbors function.</p>
<p>Parameters:
- adata_dict (dict): Dictionary of AnnData objects with keys as identifiers.
- kwargs: Additional keyword arguments to pass to the sc.pp.neighbors function.</p>
<p>Returns:
- None: The function modifies the input AnnData objects in place.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.leiden_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">leiden_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#leiden_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.leiden_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Performs Leiden clustering for each AnnData object in the dictionary using Scanpy’s leiden function.</p>
<p>Parameters:
- adata_dict (dict): Dictionary of AnnData objects with keys as identifiers.
- kwargs: Additional keyword arguments to pass to the sc.tl.leiden function.</p>
<p>Returns:
- None: The function modifies the input AnnData objects in place.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.leiden_sub_cluster">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">leiden_sub_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#leiden_sub_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.leiden_sub_cluster" title="Link to this definition"></a></dt>
<dd><p>Perform Leiden clustering on subgroups of cells.
This function applies Leiden clustering to subgroups of cells defined by the groupby parameter.</p>
<p>Parameters:
adata : AnnData Annotated data matrix.
groupby : str Column name in adata.obs for grouping cells before subclustering.
kwargs : dict Additional keyword arguments to pass to the leiden_adata_dict function.</p>
<p>Returns:
None, The function modifies the input AnnData object in-place.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.leiden_sub_cluster_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">leiden_sub_cluster_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#leiden_sub_cluster_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.leiden_sub_cluster_adata_dict" title="Link to this definition"></a></dt>
<dd><p>This function applies the leiden_sub_cluster function to each AnnData object
in the provided dictionary.</p>
<p>Parameters:
adata_dict : dict Dictionary of AnnData objects.
groupby : str Column name in adata.obs for grouping cells before subclustering.
kwargs : dict Additional keyword arguments to pass to the leiden_sub_cluster function.</p>
<p>Returns:
None The function modifies the input AnnData objects in-place.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.calculate_umap_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">calculate_umap_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#calculate_umap_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.calculate_umap_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Calculates UMAP embeddings for each subset in the adata_dict.</p>
<p>Parameters:
- adata_dict (dict): A dictionary with keys as strata and values as AnnData objects.
- kwargs: Additional keyword arguments, including ‘use_rep’ which specifies the key in .obsm where the representation matrix is stored.</p>
<p>Returns:
- dict: A dictionary with the same keys as adata_dict, but values now include UMAP coordinates.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.plot_umap_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">plot_umap_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#plot_umap_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.plot_umap_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Plots UMAP embeddings for each AnnData object in adata_dict, colored by a specified variable.</p>
<p>Parameters:
- adata_dict (dict): A dictionary with keys as strata and values as AnnData objects.
- kwargs: Additional keyword arguments, including ‘color_by’ which specifies a variable by which to color the UMAP plots, typically a column in .obs.</p>
<p>Returns:
- None: The function creates plots for the AnnData objects.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.write_h5ad_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">write_h5ad_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#write_h5ad_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.write_h5ad_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Saves each AnnData object from adata_dict into separate .h5ad files.</p>
<p>Parameters:
- adata_dict: Dictionary of AnnData objects, with keys as identifiers.
- directory: String, directory path where .h5ad files will be saved.
- file_prefix: String, optional prefix for the filenames.</p>
<p>Example:
- If <code class="docutils literal notranslate"><span class="pre">file_prefix</span></code> is <code class="docutils literal notranslate"><span class="pre">experiment1_</span></code>, files will be named <code class="docutils literal notranslate"><span class="pre">experiment1_group1.h5ad</span></code> for a key <code class="docutils literal notranslate"><span class="pre">group1</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.stable_label_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">stable_label_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stability_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_average_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#stable_label_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.stable_label_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Trains a classifier for each AnnData object in adata_dict.</p>
<p>Parameters:
adata_dict (dict): Dictionary with keys as identifiers and values as AnnData objects.
feature_key (str): Key to access the features in adata.obsm.
label_key (str): Key to access the labels in adata.obs.
classifier: Classifier instance that implements fit and predict_proba methods.
max_iterations, stability_threshold, moving_average_length, random_state: Additional parameters for training.
kwargs: Additional keyword arguments to pass to the classifier constructor.</p>
<p>Returns:
results: Dict, keys are the identifiers from adata_dict and values are dictionaries containing the outputs from stable_label_adata.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.predict_labels_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">predict_labels_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stable_label_results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#predict_labels_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.predict_labels_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Predicts labels for each AnnData object in adata_dict using the corresponding classifier from stable_label_results,
and converts numeric predictions back to text labels.</p>
<p>Parameters:
adata_dict (dict): Dictionary with keys as identifiers and values as AnnData objects.
stable_label_results (dict): Dictionary with keys as identifiers and values as dictionaries containing the trained classifier and other outputs from stable_label_adata.
feature_key (str): Key to access the features in adata.obsm.</p>
<p>Returns:
predictions_dict (dict): Dictionary with keys as identifiers from adata_dict and values as predicted text labels.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.update_adata_labels_with_stable_label_results_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">update_adata_labels_with_stable_label_results_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stable_label_results_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_label_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stable_cell_type'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#update_adata_labels_with_stable_label_results_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.update_adata_labels_with_stable_label_results_dict" title="Link to this definition"></a></dt>
<dd><p>Updates each AnnData object in adata_dict with new labels from stable_label_results_dict.</p>
<p>Parameters:
- adata_dict: Dictionary of AnnData objects to be updated.
- stable_label_results_dict: Dictionary of dictionaries containing results, including indices and final_labels for each AnnData key.
- new_label_key: Name of the new column in adata.obs where the labels will be stored.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.update_adata_labels_with_predictions_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">update_adata_labels_with_predictions_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_label_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'predicted_cell_type'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#update_adata_labels_with_predictions_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.update_adata_labels_with_predictions_dict" title="Link to this definition"></a></dt>
<dd><p>Updates each AnnData object in adata_dict with new labels from predictions_dict.</p>
<p>Parameters:
- adata_dict: Dictionary of AnnData objects to be updated.
- predictions_dict: Dictionary of predicted labels for each AnnData key.
- new_label_key: Name of the new column in adata.obs where the labels will be stored.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.update_adata_dict_with_label_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">update_adata_dict_with_label_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_label_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#update_adata_dict_with_label_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.update_adata_dict_with_label_dict" title="Link to this definition"></a></dt>
<dd><p>Wrapper function to update each AnnData object in adata_dict with new labels from results_dict.
Accepts either ‘final_labels’ or ‘predicted_labels’ as the label key.
results_dict can be either 1) stable_label_results: the object returned by stable_label_adata_dict()
or 2) predictions_dict: the object returned by predict_labels_adata_dict</p>
<p>Parameters:
- adata_dict: Dictionary of AnnData objects to be updated.
- results_dict: Dictionary containing results, including indices and labels for each AnnData key.
- new_label_key: Name of the new column in adata.obs where the labels will be stored.
- label_key: Key to access the labels in results_dict (either ‘final_labels’ or ‘predicted_labels’).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.plot_changes_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">plot_changes_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_label_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_label_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#plot_changes_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.plot_changes_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Applies the plot_final_mismatches function to each AnnData object in adata_dict.</p>
<p>Parameters:
adata_dict (dict): Dictionary with keys as identifiers and values as AnnData objects.
predicted_label_key (str): The key in obs for predicted labels.
true_label_key (str): The key in obs for true labels.
percentage (bool): If True, plot percentages, otherwise plot counts.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.plot_confusion_matrix_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">plot_confusion_matrix_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_label_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_label_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_color_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_color_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagonalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#plot_confusion_matrix_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.plot_confusion_matrix_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Applies the plot_confusion_matrix_from_adata function to each AnnData object in adata_dict.</p>
<p>Parameters:
adata_dict (dict): Dictionary with keys as identifiers and values as AnnData objects.
true_label_key (str): The key in obs for true class labels.
predicted_label_key (str): The key in obs for predicted class labels.
title (str): Title of the plot, which will be prefixed with the stratum name.
row_color_keys (list): Optional keys for row colors in adata.obs.
col_color_keys (list): Optional keys for column colors in adata.obs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.harmony_label_transfer_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">harmony_label_transfer_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master_subset_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tissue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cell_type'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#harmony_label_transfer_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.harmony_label_transfer_adata_dict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_determine_leiden_resolution">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_determine_leiden_resolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_resolution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_determine_leiden_resolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_determine_leiden_resolution" title="Link to this definition"></a></dt>
<dd><p>Adjusts the Leiden clustering resolution of an AnnData object based on AI feedback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – The annotated data matrix.</p></li>
<li><p><strong>initial_resolution</strong> (<em>float</em>) – The initial resolution for Leiden clustering.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The final resolution value after adjustments based on AI interpretation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p>This function iteratively performs Leiden clustering on the AnnData object,
generates a UMAP plot, and uses an AI model to interpret the plot and suggest
whether to increase, decrease, or maintain the current resolution. The resolution
is adjusted by ±0.1 based on the AI’s suggestion until no further adjustment is needed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_determine_leiden_resolution_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_determine_leiden_resolution_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_determine_leiden_resolution_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_determine_leiden_resolution_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Adjusts Leiden clustering resolution for each AnnData object in a dictionary based on AI feedback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata_dict</strong> (<em>dict</em>) – Dictionary of AnnData objects.</p></li>
<li><p><strong>initial_resolution</strong> (<em>float</em>) – Initial resolution for Leiden clustering (default is 1).</p></li>
</ul>
</dd>
</dl>
<p>Returns: dict: Dictionary with final resolution values after AI-based adjustments.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.simplify_obs_column">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">simplify_obs_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_column_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplification_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#simplify_obs_column"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.simplify_obs_column" title="Link to this definition"></a></dt>
<dd><p>Simplifies labels in the specified column of the AnnData object and stores the result
in a new column using the map_cell_type_labels_to_simplified_set().</p>
<p>Args:
adata (AnnData): The AnnData object containing the data.
column (str): The column in adata.obs containing the cell type labels to simplify.
new_column_name (str): The name of the new column to store the simplified labels.
simplification_level (str, optional): Defaults to ‘’. A qualitative description of how much you want the labels to be simplified. Could be anything, like  ‘extremely’, ‘barely’, or ‘compartment-level’.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.simplify_obs_column_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">simplify_obs_column_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_column_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplification_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#simplify_obs_column_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.simplify_obs_column_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Applies simplify_obs_column to each anndata in an anndict</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.create_label_hierarchy">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">create_label_hierarchy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplification_levels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#create_label_hierarchy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.create_label_hierarchy" title="Link to this definition"></a></dt>
<dd><p>Create a hierarchy of simplified labels based on a given column in AnnData.</p>
<p>This function generates multiple levels of simplified labels from an original
column in the AnnData object. Each level of simplification is created using
the specified simplification levels.</p>
<p>Parameters:
adata : AnnData Annotated data matrix containing the column to be simplified.
col : str Name of the column in adata.obs to be simplified.
simplification_levels : list List of simplification levels to apply. Each level should be a value that can be used by the simplify_obs_column function.</p>
<section id="returns">
<h2>Returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h2>
<p>dict A dictionary mapping new column names to their corresponding simplified label mappings. The keys are the names of the new columns created for each simplification level, and the values are the mappings returned by simplify_obs_column for each level.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.create_label_hierarchy_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">create_label_hierarchy_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplification_levels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#create_label_hierarchy_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.create_label_hierarchy_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Applies create_label_hierarchy to each anndata in an anndict</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.simplify_var_index">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">simplify_var_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_column_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplification_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#simplify_var_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.simplify_var_index" title="Link to this definition"></a></dt>
<dd><p>Simplifies gene names in the index of the AnnData object’s var attribute based on a boolean column,
and stores the result in a new column using the map_gene_labels_to_simplified_set().</p>
<p>Args:
adata (AnnData): The AnnData object containing the data.
column (str): The boolean column in adata.var used to select genes for simplification.
new_column_name (str): The name of the new column to store the simplified labels.
simplification_level (str, optional): Defaults to ‘’. A qualitative description of how much you want the labels to be simplified. Could be anything, like ‘extremely’, ‘barely’, or ‘compartment-level’.</p>
<p>Raises:
ValueError: If more than 1000 genes are selected for simplification or if the column is not boolean.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.simplify_var_index_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">simplify_var_index_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_column_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplification_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#simplify_var_index_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.simplify_var_index_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Applies simplify_var_index to each anndata in an anndict</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_annotate_cell_type">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_annotate_cell_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_top_genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ai_cell_type'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tissue_of_origin_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_annotate_cell_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_annotate_cell_type" title="Link to this definition"></a></dt>
<dd><p>Annotate cell types based on the top marker genes for each cluster.</p>
<p>This function performs differential expression analysis to identify marker genes for each cluster
and applies ai_annotate_cell_type to determine the cell type for each cluster based on the top
marker genes. The results are added to the AnnData object and returned as a DataFrame.</p>
<p>Parameters:
adata : AnnData
groupby : str Column in adata.obs to group by for differential expression analysis.
n_top_genes : int The number of top marker genes to consider for each cluster.
label_column : str, optional (default: ‘ai_cell_type’) The name of the new column in adata.obs where the cell type annotations will be stored.</p>
<p>Returns:
pd.DataFrame A DataFrame with a column for the top marker genes for each cluster.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_annotate_cell_type_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_annotate_cell_type_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_top_genes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ai_cell_type'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tissue_of_origin_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_annotate_cell_type_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_annotate_cell_type_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Applies ai_annotate_cell_type to each anndata in an anndict</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_annotate_cell_sub_type_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_annotate_cell_sub_type_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_type_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_cluster_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_label_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tissue_of_origin_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_top_genes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_annotate_cell_sub_type_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_annotate_cell_sub_type_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Annotate cell subtypes for a dictionary of AnnData objects.</p>
<p>This function applies the ai_annotate_cell_sub_type function to each AnnData object
in the provided dictionary.</p>
<p>Parameters:
adata_dict : dict Dictionary of AnnData objects.
cell_type_col : str Column name in adata.obs containing main cell type labels.
new_label_col : str Name of the column to store the AI-generated subtype labels.</p>
<p>Returns:
dict Dictionary of annotated AnnData objects with AI-generated subtype labels.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_annotate_cell_sub_type">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_annotate_cell_sub_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_type_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_cluster_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_label_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tissue_of_origin_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_top_genes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_annotate_cell_sub_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_annotate_cell_sub_type" title="Link to this definition"></a></dt>
<dd><p>Annotate cell subtypes using AI.</p>
<p>This function performs AI-based annotation of cell subtypes by first grouping cells
by their main cell type, then annotating subtypes within each group.</p>
<p>Parameters:
adata : AnnData Annotated data matrix.
cell_type_col : str Column name in adata.obs containing main cell type labels.
sub_cluster_col : str Column name in adata.obs containing sub-cluster information.
new_label_col : str Name of the column to store the AI-generated subtype labels.</p>
<section id="id1">
<h2>Returns:<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p>tuple A tuple containing:
AnnData: Concatenated annotated data with AI-generated subtype labels.
dict: Mapping of original labels to AI-generated labels.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_annotate_cell_type_by_comparison_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_annotate_cell_type_by_comparison_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_top_genes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ai_cell_type_by_comparison'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_type_of_origin_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tissue_of_origin_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_annotate_cell_type_by_comparison_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_annotate_cell_type_by_comparison_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Applies ai_annotate_cell_type_by_comparison to each anndata in an anndict</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_annotate_cell_type_by_comparison">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_annotate_cell_type_by_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_top_genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ai_cell_type_by_comparison'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_type_of_origin_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tissue_of_origin_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adt_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_annotate_cell_type_by_comparison"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_annotate_cell_type_by_comparison" title="Link to this definition"></a></dt>
<dd><p>Annotate cell types by comparison using AI.</p>
<p>This function wraps the ai_annotate function to perform cell type annotation
based on comparison of gene expression profiles.</p>
<p>Parameters:
adata : AnnData Annotated data matrix.
groupby : str Column name in adata.obs for grouping cells.
n_top_genes : int Number of top genes to consider for annotation.
label_column : str, optional Name of the column to store the AI-generated cell type labels (default: ‘ai_cell_type_by_comparison’).</p>
<p>Returns:
AnnData Annotated data with AI-generated cell type labels.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_annotate_biological_process">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_annotate_biological_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_top_genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ai_biological_process'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_annotate_biological_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_annotate_biological_process" title="Link to this definition"></a></dt>
<dd><p>Annotate biological processes based on the top n marker genes for each cluster.</p>
<p>This function performs differential expression analysis to identify marker genes for each cluster
and applies a user-defined function to determine the biological processes for each cluster based on the top
marker genes. The results are added to the AnnData object and returned as a DataFrame.</p>
<p>Parameters:
adata : AnnData
groupby : str Column in adata.obs to group by for differential expression analysis.
n_top_genes : int The number of top marker genes to consider for each cluster.
label_column : str, optional (default: ‘ai_cell_type’) The name of the new column in adata.obs where the cell type annotations will be stored.</p>
<p>Returns:
pd.DataFrame A DataFrame with a column for the top marker genes for each cluster.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_annotate_biological_process_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_annotate_biological_process_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_top_genes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ai_biological_process'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_annotate_biological_process_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_annotate_biological_process_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Applies ai_annotate_biological_process to each anndata in an anndict</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_annotate_by_comparison">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_annotate_by_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_top_genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_type_of_origin_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tissue_of_origin_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_annotate_by_comparison"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_annotate_by_comparison" title="Link to this definition"></a></dt>
<dd><p>Annotate clusters based on the top marker genes for each cluster.</p>
<p>This uses marker genes for each cluster and applies func to determine the label for each cluster based on the top n
marker genes. The results are added to the AnnData object and returned as a DataFrame.</p>
<p>If rank_genes_groups hasn’t been run on the adata, this function will automatically run sc.tl.rank_genes_groups</p>
<p>Parameters:
adata : AnnData
groupby : str Column in adata.obs to group by for differential expression analysis.
n_top_genes : int The number of top marker genes to consider for each cluster.
label_column : str The name of the new column in adata.obs where the annotations will be stored.</p>
<p>Returns:
pd.DataFrame A DataFrame with a column for the top marker genes for each cluster.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_annotate">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_annotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_top_genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tissue_of_origin_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_annotate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_annotate" title="Link to this definition"></a></dt>
<dd><p>Annotate clusters based on the top marker genes for each cluster.</p>
<p>This uses marker genes for each cluster and applies func to determine the label for each cluster based on the top n
marker genes. The results are added to the AnnData object and returned as a DataFrame.</p>
<p>If rank_genes_groups hasn’t been run on the adata, this function will automatically run sc.tl.rank_genes_groups</p>
<p>Parameters:
adata : AnnData
groupby : str Column in adata.obs to group by for differential expression analysis.
n_top_genes : int The number of top marker genes to consider for each cluster.
label_column : str The name of the new column in adata.obs where the annotations will be stored.</p>
<p>Returns:
pd.DataFrame A DataFrame with a column for the top marker genes for each cluster.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_unify_labels">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_unify_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_columns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_label_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplification_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'unified,</span> <span class="pre">typo-fixed'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_unify_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_unify_labels" title="Link to this definition"></a></dt>
<dd><p>Unifies cell type labels across multiple AnnData objects by mapping them to a simplified, unified set of labels.</p>
<p>Parameters:
adata_dict (dict): Dictionary where keys are identifiers and values are AnnData objects.
label_columns (dict): Dictionary where keys should be the same as the keys of adata_dict and values are the column names in .obs containing the original labels.
new_label_column (str): Name of the new column to be created in .obs for storing the harmonized labels.</p>
<p>Returns:
dict: A mapping dictionary where the keys are the original labels and the values are the unified labels.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ensure_label_consistency_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ensure_label_consistency_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplification_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'unified,</span> <span class="pre">typo-fixed'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_col_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'consistent'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ensure_label_consistency_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ensure_label_consistency_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Apply label consistency across multiple AnnData objects in a dictionary.</p>
<p>This function applies ensure_label_consistency_adata to each AnnData in adata_dict.</p>
<p>Parameters:
adata_dict : dict Dictionary of AnnData objects.
cols : list List of column names in adata.obs for which label consistency is enforced.
simplification_level : str, optional Level of label simplification (default is ‘unified, typo-fixed’).
new_col_prefix : str, optional Prefix for the new consistent label columns (default is ‘consistent’).</p>
<p>See ensure_label_consistency_adata for details.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ensure_label_consistency_adata">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ensure_label_consistency_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplification_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'unified,</span> <span class="pre">typo-fixed'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_col_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'consistent'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ensure_label_consistency_adata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ensure_label_consistency_adata" title="Link to this definition"></a></dt>
<dd><p>Wrapper function to ensure label consistency across specified columns in an AnnData object.</p>
<p>Parameters:
- adata: AnnData object
- cols: List of column names in adata.obs to ensure label consistency
- simplification_level: Level of simplification for label mapping
- new_col_prefix: Prefix to create new columns in adata.obs. Default is “” (overwrites original columns).</p>
<p>Returns:
- Updated adata with consistent labels in adata.obs[new_col_prefix + cols]
- label_map: Dictionary mapping original labels to the simplified labels</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ensure_label_consistency_main">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ensure_label_consistency_main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplification_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'unified,</span> <span class="pre">typo-fixed'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ensure_label_consistency_main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ensure_label_consistency_main" title="Link to this definition"></a></dt>
<dd><p>Function to ensure label consistency across multiple columns in a DataFrame
by mapping labels to a unified and simplified set.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.create_label_df">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">create_label_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#create_label_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.create_label_df" title="Link to this definition"></a></dt>
<dd><p>Create a DataFrame of unique label combinations from the specified columns in cols1 and cols2,
only including combinations that exist in adata.obs.
Parameters:
adata: AnnData object containing the data.
cols1: List of columns to compare against cols2.
cols2: List of columns to compare with cols1.
Returns:
pd.DataFrame: DataFrame containing unique combinations of the specified columns.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_compare_cell_type_labels_pairwise">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_compare_cell_type_labels_pairwise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_col_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'agreement'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comparison_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'binary'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_compare_cell_type_labels_pairwise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_compare_cell_type_labels_pairwise" title="Link to this definition"></a></dt>
<dd><p>Compare cell type labels by finding unique combinations between labels in cols1 and cols2,
applying the comparison, and mapping the results back to adata.obs.
Parameters:
adata: AnnData object containing the data.
cols1: List of columns to compare against cols2.
cols2: List of columns to compare with cols1.
new_col_prefix: The base name for the new comparison result columns.
comparison_level: ‘binary’ or ‘categorical’, determines which comparison function to use.
Returns:
dict: Dictionary with keys as tuples of (col1, col2) and values as DataFrames with the comparison results.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.ai_compare_cell_type_labels_pairwise_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">ai_compare_cell_type_labels_pairwise_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_col_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'agreement'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comparison_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'binary'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#ai_compare_cell_type_labels_pairwise_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.ai_compare_cell_type_labels_pairwise_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Applies ai_compare_cell_type_labels_pairwise to each anndata in an anndict.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.plot_sankey_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">plot_sankey_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#plot_sankey_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.plot_sankey_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Applies plot_sankey to each anndata in an anndict</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.save_sankey_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">save_sankey_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#save_sankey_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.save_sankey_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Saves each sankey plot in a dictionary (i.e. the return value of plot_sankey_adata_dict)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.dict.plot_grouped_average_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.dict.</span></span><span class="sig-name descname"><span class="pre">plot_grouped_average_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/dict.html#plot_grouped_average_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.dict.plot_grouped_average_adata_dict" title="Link to this definition"></a></dt>
<dd><p>plots the grouped average of a value for each group of a label. label_value must be a dictionary of dictionaries. For example, if adata_dict has two anndata with keys ‘ad1’ and ‘ad2’, then setting label_value = {‘ad1’:{‘cell_type’:’pct_counts_mt’}, ‘ad2’:{‘cell_type’:’pct_counts_mt’}} would plot the average of pct_counts_mt for each cell type in the anndata on separate plots for each anndata in adata_dict.</p>
</dd></dl>

<dl class="py function" id="module-anndict.strata">
<dt class="sig sig-object py" id="anndict.strata.preprocess_adata_strata">
<span class="sig-prename descclassname"><span class="pre">anndict.strata.</span></span><span class="sig-name descname"><span class="pre">preprocess_adata_strata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strata_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_cells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/strata.html#preprocess_adata_strata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.strata.preprocess_adata_strata" title="Link to this definition"></a></dt>
<dd><p>Preprocess an AnnData object by stratifying, filtering, and subsampling based on specified criteria.</p>
<p>Parameters:
adata (AnnData): Annotated data matrix.
strata_keys (list of str): List of column names in <cite>adata.obs</cite> to use for stratification.
target_cells (int, optional): Target number of cells to retain per stratum. Default is 10000.
min_cells (int, optional): Minimum number of cells required to retain a stratum. Default is 25.</p>
<p>Returns:
AnnData: Concatenated AnnData object after filtering and subsampling.</p>
<p>Raises:
ValueError: If no strata meet the minimum cell requirement after filtering.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.strata.stable_label_adata_strata">
<span class="sig-prename descclassname"><span class="pre">anndict.strata.</span></span><span class="sig-name descname"><span class="pre">stable_label_adata_strata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strata_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stability_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_average_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/strata.html#stable_label_adata_strata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.strata.stable_label_adata_strata" title="Link to this definition"></a></dt>
<dd><p>Trains a classifier for each stratum specified in adata.obs using a strata_key.</p>
<p>Parameters:
- adata: AnnData object containing the dataset.
- feature_key: str, key to access the features in adata.obsm.
- label_key: str, key to access the labels in adata.obs.
- strata_key: str, key to differentiate strata in adata.obs.
- classifier: classifier instance that implements fit and predict_proba methods.
- max_iterations, stability_threshold, moving_average_length, random_state: passed directly to train_classifier_with_categorical_labels.</p>
<p>Returns:
- results: dict, keys are strata labels and values are lists containing the outputs from train_classifier_with_categorical_labels.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.strata.plot_confusion_matrix_across_strata">
<span class="sig-prename descclassname"><span class="pre">anndict.strata.</span></span><span class="sig-name descname"><span class="pre">plot_confusion_matrix_across_strata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_label_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_label_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strata_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Confusion</span> <span class="pre">Matrix'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/strata.html#plot_confusion_matrix_across_strata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.strata.plot_confusion_matrix_across_strata" title="Link to this definition"></a></dt>
<dd><p>Wrapper function to plot confusion matrices for different strata in an AnnData object.</p>
<p>Parameters:
- adata: AnnData object containing the dataset.
- true_label_key: str, key to access the true class labels in adata.obs.
- predicted_label_key: str, key to access the predicted class labels in adata.obs.
- strata_keys: list of str, keys to use for stratifying the data.
- title: str, prefix to the title of the plot for each stratum.</p>
</dd></dl>

<dl class="py function" id="module-anndict.utils">
<dt class="sig sig-object py" id="anndict.utils.make_names">
<span class="sig-prename descclassname"><span class="pre">anndict.utils.</span></span><span class="sig-name descname"><span class="pre">make_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/utils.html#make_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.utils.make_names" title="Link to this definition"></a></dt>
<dd><p>Convert a list of names into valid and unique Python identifiers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>names</strong> (<em>list</em><em> of </em><em>str</em>) – List of names to be transformed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Valid and unique Python identifiers.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.utils.normalize_string">
<span class="sig-prename descclassname"><span class="pre">anndict.utils.</span></span><span class="sig-name descname"><span class="pre">normalize_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/utils.html#normalize_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.utils.normalize_string" title="Link to this definition"></a></dt>
<dd><p>Removes non-alphanumeric characters and converts to lowercase.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.utils.normalize_label">
<span class="sig-prename descclassname"><span class="pre">anndict.utils.</span></span><span class="sig-name descname"><span class="pre">normalize_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/utils.html#normalize_label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.utils.normalize_label" title="Link to this definition"></a></dt>
<dd><p>Calls normalize-string and handles NaN values.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.utils.add_label_to_adata">
<span class="sig-prename descclassname"><span class="pre">anndict.utils.</span></span><span class="sig-name descname"><span class="pre">add_label_to_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_label_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/utils.html#add_label_to_adata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.utils.add_label_to_adata" title="Link to this definition"></a></dt>
<dd><p>Adds a label to the AnnData object in a specified column for given indices.</p>
<p>Parameters:
- adata: AnnData object to be updated.
- indices: Array of indices where labels will be assigned.
- labels: Array of labels corresponding to the indices.
- new_label_key: Name of the column in adata.obs where the labels will be stored.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.utils.add_col_to_adata_obs">
<span class="sig-prename descclassname"><span class="pre">anndict.utils.</span></span><span class="sig-name descname"><span class="pre">add_col_to_adata_obs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_col_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/utils.html#add_col_to_adata_obs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.utils.add_col_to_adata_obs" title="Link to this definition"></a></dt>
<dd><p>Adds a label to the AnnData object in a specified column for given indices.</p>
<p>Parameters:
- adata: AnnData object to be updated.
- indices: Array of indices where labels will be assigned.
- values: Array of labels corresponding to the indices.
- new_col_name: Name of the column in adata.obs where the labels will be stored.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.utils.add_col_to_adata_var">
<span class="sig-prename descclassname"><span class="pre">anndict.utils.</span></span><span class="sig-name descname"><span class="pre">add_col_to_adata_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_col_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/utils.html#add_col_to_adata_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.utils.add_col_to_adata_var" title="Link to this definition"></a></dt>
<dd><p>Adds a label to the AnnData object in a specified column for given indices in adata.var.</p>
<p>Parameters:
- adata: AnnData object to be updated.
- indices: Array of indices where labels will be assigned.
- values: Array of labels corresponding to the indices.
- new_label_key: Name of the column in adata.var where the labels will be stored.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.utils.convert_obs_col_to_category">
<span class="sig-prename descclassname"><span class="pre">anndict.utils.</span></span><span class="sig-name descname"><span class="pre">convert_obs_col_to_category</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/utils.html#convert_obs_col_to_category"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.utils.convert_obs_col_to_category" title="Link to this definition"></a></dt>
<dd><p>Convert a column in AnnData.obs to category dtype.</p>
<p>Parameters:
adata (AnnData): The AnnData object.
col_name (str): The name of the column in adata.obs to convert.</p>
<p>Returns:
None: The function modifies the adata object in-place.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.utils.convert_obs_col_to_string">
<span class="sig-prename descclassname"><span class="pre">anndict.utils.</span></span><span class="sig-name descname"><span class="pre">convert_obs_col_to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/utils.html#convert_obs_col_to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.utils.convert_obs_col_to_string" title="Link to this definition"></a></dt>
<dd><p>Convert a column in AnnData.obs to string dtype.</p>
<p>Parameters:
adata (AnnData): The AnnData object.
col_name (str): The name of the column in adata.obs to convert.</p>
<p>Returns:
None: The function modifies the adata object in-place.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.utils.convert_obs_index_to_str">
<span class="sig-prename descclassname"><span class="pre">anndict.utils.</span></span><span class="sig-name descname"><span class="pre">convert_obs_index_to_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/utils.html#convert_obs_index_to_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.utils.convert_obs_index_to_str" title="Link to this definition"></a></dt>
<dd><p>Converts the index of .obs to a string</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.utils.get_adata_columns">
<span class="sig-prename descclassname"><span class="pre">anndict.utils.</span></span><span class="sig-name descname"><span class="pre">get_adata_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_startswith</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_endswith</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_contains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">not_col_startswith</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">not_col_endswith</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">not_col_contains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/utils.html#get_adata_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.utils.get_adata_columns" title="Link to this definition"></a></dt>
<dd><p>Extract columns from an AnnData object’s observation dataframe (<cite>adata.obs</cite>) based on specified filtering criteria.</p>
<p>Parameters:
adata : AnnData The AnnData object containing the observation dataframe (adata.obs) from which columns are selected.
col_{startswith, endswith, contains} : list of str, optional
Lists of substrings to positively filter columns.
- col_startswith: Select columns that start with any of these strings.
- col_endswith: Select columns that end with any of these strings.
- col_contains: Select columns that contain any of these strings.
not_col_{startswith, endswith, contains} : list of str, optional
Lists of substrings to negatively filter columns from the previously selected ones.
- not_col_startswith: Exclude columns that start with any of these strings.
- not_col_endswith: Exclude columns that end with any of these strings.
- not_col_contains: Exclude columns that contain any of these strings.</p>
<p>Returns:
list of str A list of unique column names from adata.obs that match the specified criteria.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.utils.create_color_map">
<span class="sig-prename descclassname"><span class="pre">anndict.utils.</span></span><span class="sig-name descname"><span class="pre">create_color_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/utils.html#create_color_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.utils.create_color_map" title="Link to this definition"></a></dt>
<dd><p>Creates a unified color map for given keys from an AnnData object, differentiating
between continuous and categorical data.</p>
<p>Parameters:
- adata: AnnData object.
- keys: list of str, keys for which the color map is required.</p>
<p>Returns:
- dict: A color map linking unique values or ranges from the specified keys to colors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.utils.UCE_adata">
<span class="sig-prename descclassname"><span class="pre">anndict.utils.</span></span><span class="sig-name descname"><span class="pre">UCE_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_paths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/utils.html#UCE_adata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.utils.UCE_adata" title="Link to this definition"></a></dt>
<dd><p>Runs the eval_single_anndata.py script for each specified anndata path. This function is included largely for illustrative purposes and will be restrictivley slow with a gpu.</p>
<p>Parameters:
adata_paths (list of str): A list of paths to the .h5ad files to be processed.</p>
<p>This function constructs the command to run the eval_single_anndata.py script
with specified arguments and then executes the command using subprocess.run.</p>
<p>The function assumes that a uce-compatible conda environment is already activated
and the working directory is correctly set to UCE (i.e. as in <a class="reference external" href="https://github.com/snap-stanford/UCE">https://github.com/snap-stanford/UCE</a>)</p>
<p>Example usage:
UCE_adata([“../dat/liver.h5ad”, “../dat/kidney.h5ad”])</p>
</dd></dl>

<dl class="py function" id="module-anndict.ai">
<dt class="sig sig-object py" id="anndict.ai.bedrock_init">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">bedrock_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">constructor_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/anndict/ai.html#bedrock_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.bedrock_init" title="Link to this definition"></a></dt>
<dd><p>Initialization function for Bedrock</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.azureml_init">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">azureml_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">constructor_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/anndict/ai.html#azureml_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.azureml_init" title="Link to this definition"></a></dt>
<dd><p>Initialization function for AzureML Endpoint</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.google_genai_init">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">google_genai_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">constructor_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#google_genai_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.google_genai_init" title="Link to this definition"></a></dt>
<dd><p>Initialization function for Google (Gemini) API. Among other things, sets GRPC_VERBOSITY env variable to ERROR.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.default_init">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">default_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">constructor_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#default_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.default_init" title="Link to this definition"></a></dt>
<dd><p>Default initialization function that sets a rate limiter</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.configure_llm_backend">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">configure_llm_backend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">provider</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#configure_llm_backend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.configure_llm_backend" title="Link to this definition"></a></dt>
<dd><p>Configures the LLM backend by setting environment variables.</p>
<p>See keys of PROVIDER_MODELS for valid providers.</p>
<p>See values of PROVIDER_MODELS for valid models from each provider.</p>
<p>To view PROVIDER_MODELS:</p>
<p>import anndict as adt</p>
<p>adt.PROVIDER_MODELS</p>
<p>api_key is a provider-specific API key that you will have to obtain from your specified provider</p>
<p class="rubric">Examples</p>
<p># General (for most providers)</p>
<p>configure_llm_backend(‘your-provider-name’,
‘your-provider-model-name’,
api_key=’your-provider-api-key’)</p>
<p># For general example (OpenAI), works the same for providers google and anthropic.</p>
<p>configure_llm_backend(‘openai’, ‘gpt-3.5-turbo’, api_key=’your-openai-api-key’)
configure_llm_backend(‘anthropic’, ‘claude-3-5-sonnet-20240620’, api_key=’your-anthropic-api-key’)</p>
<p># For AzureML Endpoint</p>
<p>configure_llm_backend(‘azureml_endpoint’, ‘llama-2’, endpoint_name=’your-endpoint-name’, region=’your-region’, api_key=’your-api-key’)</p>
<p># For Bedrock</p>
<p>configure_llm_backend(‘bedrock’, ‘anthropic.claude-v2’, region_name=’us-west-2’, aws_access_key_id=’your-access-key-id’, aws_secret_access_key=’your-secret-access-key’)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.get_llm_config">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">get_llm_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#get_llm_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.get_llm_config" title="Link to this definition"></a></dt>
<dd><p>Retrieves the LLM configuration from environment variables.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.get_llm">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">get_llm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#get_llm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.get_llm" title="Link to this definition"></a></dt>
<dd><p>Dynamically retrieves the appropriate LLM based on the configuration.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.call_llm">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">call_llm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">messages</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#call_llm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.call_llm" title="Link to this definition"></a></dt>
<dd><p>Calls the configured LLM provider with the given parameters.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.retry_llm_call">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">retry_llm_call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">messages</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_response</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">failure_handler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_attempts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_llm_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_response_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">failure_handler_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#retry_llm_call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.retry_llm_call" title="Link to this definition"></a></dt>
<dd><p>A generic wrapper for LLM calls that implements retry logic with custom processing and failure handling.</p>
<p>Args:
messages (list): The messages or prompt to send to the LLM.
process_response (callable): A function that takes the LLM output and attempts to process it into the desired result.
failure_handler (callable): A function to call if max_attempts is reached without successful processing.
max_attempts (int): Maximum number of attempts before calling the failure_handler function.
call_llm_kwargs (dict): Keyword arguments to pass to the LLM call function.
process_response_kwargs (dict): Keyword arguments to pass to the process_response function.
failure_handler_kwargs (dict): Keyword arguments to pass to the failure_handler function.</p>
<p>Returns:
The result of process_response if successful, or the result of failure_handler if not.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.enforce_semantic_list">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">enforce_semantic_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#enforce_semantic_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.enforce_semantic_list" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.extract_dictionary_from_ai_string">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">extract_dictionary_from_ai_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ai_string</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#extract_dictionary_from_ai_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.extract_dictionary_from_ai_string" title="Link to this definition"></a></dt>
<dd><p>Cleans a generated string by removing everything before the first ‘{’
and everything after the first ‘}’.</p>
<p>Args:
generated_string (str): The string generated by retry_call_llm which includes unwanted characters or code.</p>
<p>Returns:
str: A cleaned string that can be evaluated as a dictionary.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.attempt_ai_integration">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">attempt_ai_integration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ai_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fallback_func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#attempt_ai_integration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.attempt_ai_integration" title="Link to this definition"></a></dt>
<dd><p>Attempts to run the AI integration function with the provided arguments. If an exception occurs,
runs the fallback function instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ai_func</strong> (<em>callable</em>) – The AI integration function to run.</p></li>
<li><p><strong>fallback_func</strong> (<em>callable</em>) – The fallback function to run if the AI function fails.</p></li>
<li><p><strong>args</strong> – Variable length argument list for the AI function.</p></li>
<li><p><strong>kwargs</strong> – Arbitrary keyword arguments for the AI function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the AI function if it succeeds, otherwise the result of the fallback function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.generate_file_key">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">generate_file_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#generate_file_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.generate_file_key" title="Link to this definition"></a></dt>
<dd><p>Generates a concise, descriptive name for a file based on its file path using the configured AI model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>str</em>) – The path to the file for which to generate a name.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A generated name for the file that can be used as a dictionary key.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.process_llm_category_mapping">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">process_llm_category_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_categories</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llm_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#process_llm_category_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.process_llm_category_mapping" title="Link to this definition"></a></dt>
<dd><p>Map original categories to simplified categories using LLM output.</p>
<p>Normalizes strings, finds exact or close matches between original categories
and LLM-provided keys, and creates a mapping. If no match is found, the
original category is used.</p>
<p>Args:
original_categories (list): List of original category strings.
llm_dict (dict): Dictionary of LLM-provided category mappings.</p>
<p>Returns:
dict: Mapping of original categories to simplified categories.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.map_cell_type_labels_to_simplified_set">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">map_cell_type_labels_to_simplified_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplification_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#map_cell_type_labels_to_simplified_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.map_cell_type_labels_to_simplified_set" title="Link to this definition"></a></dt>
<dd><p>Maps a list of labels to a smaller set of labels using the AI, processing in batches.
Args:
labels (list of str): The list of labels to be mapped.
simplification_level (str): A qualitative description of how much you want the labels to be simplified. Or a direction about how to simplify the labels. Could be anything, like ‘extremely’, ‘barely’, ‘compartment-level’, ‘remove-typos’
batch_size (int): The number of labels to process in each batch.
Returns:
dict: A dictionary mapping the original labels to the smaller set of labels.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.map_gene_labels_to_simplified_set">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">map_gene_labels_to_simplified_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplification_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#map_gene_labels_to_simplified_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.map_gene_labels_to_simplified_set" title="Link to this definition"></a></dt>
<dd><p>Maps a list of genes to a smaller set of labels using AI, processing in batches.
Args:
labels (list of str): The list of labels to be mapped.
simplification_level (str): A qualitative description of how much you want the labels to be simplified.
batch_size (int): The number of labels to process in each batch.
Returns:
dict: A dictionary mapping the original labels to the smaller set of labels.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.ai_biological_process">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">ai_biological_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#ai_biological_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.ai_biological_process" title="Link to this definition"></a></dt>
<dd><p>Describes the most prominent biological process represented by a list of genes using the AI.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gene_list</strong> (<em>list</em><em> of </em><em>str</em>) – The list of genes to be described.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the description of the biological process.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.ai_cell_type">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">ai_cell_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tissue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#ai_cell_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.ai_cell_type" title="Link to this definition"></a></dt>
<dd><p>Returns the cell type based on a list of marker genes as determined by AI.
Args:
gene_list (list of str): The list of genes to be described.
tissue (str, optional): The tissue of origin to provide context for the AI.
Returns:
str: The cell type label generated by AI</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.ai_cell_types_by_comparison">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">ai_cell_types_by_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_lists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tissues</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#ai_cell_types_by_comparison"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.ai_cell_types_by_comparison" title="Link to this definition"></a></dt>
<dd><p>Returns cell type labels for multiple lists of marker genes as determined by AI.
Args:
gene_lists (list of lists): A list containing multiple lists of genes to be described.
cell_type (str, optional): The cell type to provide context for the AI.
tissue (str, optional): The tissue of origin to provide context for the AI.
Returns:
list of str: The cell type labels generated by AI for each gene list.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.ai_compare_cell_types_binary">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">ai_compare_cell_types_binary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#ai_compare_cell_types_binary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.ai_compare_cell_types_binary" title="Link to this definition"></a></dt>
<dd><p>Compares two cell type labels using AI.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item1</strong> (<em>str</em>) – The first item to compare.</p></li>
<li><p><strong>item2</strong> (<em>str</em>) – The second item to compare.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The comparison result generated by AI.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.ai_compare_cell_types_categorical">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">ai_compare_cell_types_categorical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#ai_compare_cell_types_categorical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.ai_compare_cell_types_categorical" title="Link to this definition"></a></dt>
<dd><p>Compares two cell type labels using AI.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item1</strong> (<em>str</em>) – The first item to compare.</p></li>
<li><p><strong>item2</strong> (<em>str</em>) – The second item to compare.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The comparison result generated by AI.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.encode_plot_for_openai">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">encode_plot_for_openai</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#encode_plot_for_openai"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.encode_plot_for_openai" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.ai_resolution_interpretation">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">ai_resolution_interpretation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#ai_resolution_interpretation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.ai_resolution_interpretation" title="Link to this definition"></a></dt>
<dd><p>Determines the clustering resolution adjustment based on an image of a plot using AI.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>plot</strong> (<em>function</em>) – A function that generates a matplotlib plot.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resolution adjustment suggestion generated by AI. One of “decreased”, “increased”, or “unchanged”.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.ai.determine_sign_of_resolution_change">
<span class="sig-prename descclassname"><span class="pre">anndict.ai.</span></span><span class="sig-name descname"><span class="pre">determine_sign_of_resolution_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annotation</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/ai.html#determine_sign_of_resolution_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.ai.determine_sign_of_resolution_change" title="Link to this definition"></a></dt>
<dd><p>Returns -1 if “decreased”, 1 if “increased”, and 0 if “unchanged” is in the annotation string.</p>
<p>Args: annotation (str): Annotation indicating resolution change.</p>
<p>Returns: int: -1 for “decreased”, 1 for “increased”, 0 for “unchanged” or none.</p>
</dd></dl>

<dl class="py function" id="module-anndict.metadata_summary">
<dt class="sig sig-object py" id="anndict.metadata_summary.summarize_metadata">
<span class="sig-prename descclassname"><span class="pre">anndict.metadata_summary.</span></span><span class="sig-name descname"><span class="pre">summarize_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/metadata_summary.html#summarize_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.metadata_summary.summarize_metadata" title="Link to this definition"></a></dt>
<dd><p>Generate a summary for specified metadata columns in an anndata object as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>anndata.AnnData</em>) – The anndata object containing the data.</p></li>
<li><p><strong>columns</strong> (<em>list</em><em> of </em><em>str</em>) – List of columns from the metadata.
Use ‘*’ to specify joint frequencies of multiple columns.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary with keys as column descriptions and values as a DataFrame of counts.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.metadata_summary.display_html_summary">
<span class="sig-prename descclassname"><span class="pre">anndict.metadata_summary.</span></span><span class="sig-name descname"><span class="pre">display_html_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summary_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/metadata_summary.html#display_html_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.metadata_summary.display_html_summary" title="Link to this definition"></a></dt>
<dd><p>Display separate HTML tables for each metadata category in the summary dictionary,
arranging up to three tables in a row before starting a new line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>summary_dict</strong> (<em>dict</em>) – The dictionary containing frequency data for metadata columns.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-anndict.stablelabel">
<dt class="sig sig-object py" id="anndict.stablelabel.get_slurm_cores">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">get_slurm_cores</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#get_slurm_cores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.get_slurm_cores" title="Link to this definition"></a></dt>
<dd><p>Returns the total number of CPU cores allocated to a Slurm job based on environment variables.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.pca_density_filter">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">pca_density_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#pca_density_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.pca_density_filter" title="Link to this definition"></a></dt>
<dd><p>Calculate density contours for PCA-reduced data, return the density of all input data,
and identify the unique variables that were included in the PCA.</p>
<p>Parameters:
- data: array-like, shape (n_samples, n_features)
- n_components: int, number of components for PCA to reduce the data to.</p>
<p>Returns:
- pca_data: PCA-reduced data (None if all variables are constant).
- density: Density values of all the points (None if all variables are constant).
- unique_variables: List of unique variables that were included in the PCA (empty list if all variables are constant).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.pca_density_wrapper">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">pca_density_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#pca_density_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.pca_density_wrapper" title="Link to this definition"></a></dt>
<dd><p>Apply calculate_density_contours_with_unique_variables to subsets of X indicated by labels.
Returns a vector indicating whether each row in X is above the threshold for its respective label group.</p>
<p>Parameters:
- X: array-like, shape (n_samples, n_features)
- labels: array-like, shape (n_samples,), labels indicating the subset to which each row belongs</p>
<p>Returns:
- index_vector: array-like, boolean vector of length n_samples indicating rows above the threshold</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.pca_density_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">pca_density_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#pca_density_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.pca_density_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Applies PCA-based density filtering recursively on subsets of an AnnData dictionary. Each subset
is determined by the provided keys. The function returns a dictionary where each AnnData object
has an additional metadata key indicating the result of the density filter. The structure of the
input dictionary is preserved, and each AnnData object’s metadata is updated in-place.</p>
<p>Parameters:
- adata_dict: Dictionary of AnnData objects, with keys indicating different groups.
- keys: List of keys to further stratify the AnnData objects if recursion is needed.</p>
<p>Returns:
- Dictionary: Updated adata_dict with the same keys but with each AnnData object having a new metadata key ‘density_filter’.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.stable_label">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">stable_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stability_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_average_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#stable_label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.stable_label" title="Link to this definition"></a></dt>
<dd><p>Trains a classifier using a semi-supervised approach where labels are probabilistically reassigned based on classifier predictions.</p>
<p>Parameters:
- X: ndarray, feature matrix.
- y: ndarray, initial labels for all data.
- classifier: a classifier instance that implements fit and predict_proba methods.
- max_iterations: int, maximum number of iterations for updating labels.
- stability_threshold: float, threshold for the fraction of labels changing to consider the labeling stable.
- moving_average_length: int, number of past iterations to consider for moving average.
- random_state: int or None, seed for random number generator for reproducibility.</p>
<p>Returns:
- classifier: trained classifier.
- history: list, percentage of labels that changed at each iteration.
- iterations: int, number of iterations run.
- final_labels: ndarray, the labels after the last iteration.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.stable_label_adata">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">stable_label_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stability_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_average_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#stable_label_adata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.stable_label_adata" title="Link to this definition"></a></dt>
<dd><p>A wrapper for train_classifier_with_probabilistic_labels that handles categorical labels.</p>
<p>Parameters:
- adata: AnnData object containing the dataset.
- feature_key: str, key to access the features in adata.obsm.
- label_key: str, key to access the labels in adata.obs.
- classifier: classifier instance that implements fit and predict_proba methods.
- max_iterations, stability_threshold, moving_average_length, random_state: passed directly to train_classifier_with_probabilistic_labels.</p>
<p>Returns:
- classifier: trained classifier.
- history: list, percentage of labels that changed at each iteration.
- iterations: int, number of iterations run.
- final_labels: ndarray, text-based final labels after the last iteration.
- label_encoder: the label encoder used during training (can be used to convert predictions to semantic labels)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.update_adata_labels_with_results">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">update_adata_labels_with_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_label_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stable_cell_type'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#update_adata_labels_with_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.update_adata_labels_with_results" title="Link to this definition"></a></dt>
<dd><p>Collects indices and labels from results and adds them to the AnnData object using add_label_to_adata function.</p>
<p>Parameters:
- adata: AnnData object to be updated.
- results: Dictionary containing results, including indices and final_labels.
- new_label_key: Name of the new column in adata.obs where the labels will be stored.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.plot_training_history">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">plot_training_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#plot_training_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.plot_training_history" title="Link to this definition"></a></dt>
<dd><p>Plot the training history of a model, showing percent label change versus iteration.</p>
<p>Parameters:
results (dict): Dictionary where keys are strata names and values are dictionaries containing training history.
separate (bool, optional): If True, plot each stratum’s training history separately. If False, plot all strata together. Default is True.</p>
<p>Returns:
None</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.plot_changes">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">plot_changes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_label_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_label_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stratum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#plot_changes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.plot_changes" title="Link to this definition"></a></dt>
<dd><p>Plot the changes between true and predicted labels in an AnnData object.</p>
<p>Parameters:
adata (AnnData): Annotated data matrix.
true_label_key (str): Key for the true labels in adata.obs.
predicted_label_key (str): Key for the predicted labels in adata.obs.
percentage (bool, optional): If True, plot the percentage of labels changed. If False, plot the count of labels changed. Default is True.
stratum (str, optional): Title for the plot, often used to indicate the stratum. Default is None.</p>
<p>Returns:
None</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.plot_confusion_matrix_from_adata">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">plot_confusion_matrix_from_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_label_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_label_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Confusion</span> <span class="pre">Matrix'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_color_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_color_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagonalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_ticklabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_ticklabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#plot_confusion_matrix_from_adata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.plot_confusion_matrix_from_adata" title="Link to this definition"></a></dt>
<dd><p>Wrapper function to plot a confusion matrix from an AnnData object, with optional row and column colors.</p>
<p>Parameters:
- adata: AnnData object containing the dataset.
- true_label_key: str, key to access the true class labels in adata.obs.
- predicted_label_key: str, key to access the predicted class labels in adata.obs.
- title: str, title of the plot.
- row_color_key: str, key for row colors in adata.obs.
- col_color_key: str, key for column colors in adata.obs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.plot_confusion_matrix">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">plot_confusion_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true_labels_encoded</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_labels_encoded</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Confusion</span> <span class="pre">Matrix'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_color_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_color_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_label_color_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_label_color_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagonalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_ticklabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_ticklabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#plot_confusion_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.plot_confusion_matrix" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.plot_sankey">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">plot_sankey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#plot_sankey"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.plot_sankey" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.save_sankey">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">save_sankey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adt_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#save_sankey"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.save_sankey" title="Link to this definition"></a></dt>
<dd><p>Save a Holoviews Sankey plot as an SVG file.</p>
<p>Parameters:
plot : Holoviews plot, The Sankey plot to save.
filename : str Base filename for the output SVG file.
adt_key : str, optional Optional identifier to append to the filename.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.plot_grouped_average">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">plot_grouped_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adt_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#plot_grouped_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.plot_grouped_average" title="Link to this definition"></a></dt>
<dd><p>Plots the average values specified in label_value across each group of label_keys in an AnnData object.</p>
<p>Parameters:
- adata: AnnData object containing the data.
- label_value: dict, keys are the keys in adata.obs for grouping, values are the keys in adata.obs for the values to average.
- key: to print specified key</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.plot_model_agreement">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">plot_model_agreement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_by</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_group_by</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">granularity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#plot_model_agreement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.plot_model_agreement" title="Link to this definition"></a></dt>
<dd><p>Plots the average values of specified model columns across varying levels of granularity.</p>
<p>Parameters:
- adata: AnnData object containing the data.
- group_by: str, key in adata.obs for the main grouping (e.g., ‘cell_type’).
- sub_group_by: str, key in adata.obs for the sub-grouping (e.g., ‘tissue’).
- model_cols: list of str, column names for the models (e.g., [‘agreement_model_1’, ‘agreement_model_2’]).
- granularity: int, level of detail in the plot (0 = models only, 1 = models within cell types, 2 = models within cell types and tissues).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.kappa_adata">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">kappa_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#kappa_adata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.kappa_adata" title="Link to this definition"></a></dt>
<dd><p>Calculate pairwise Cohen’s Kappa, average pairwise Kappa, and Fleiss’ Kappa
for categorical data in adata.obs[cols].
Parameters:
- adata: AnnData object.
- cols: List of columns in adata.obs to use for calculating agreement.
Returns:
- Dictionary with keys ‘pairwise’, ‘average_pairwise’, and ‘fleiss’:
- ‘pairwise’: A dictionary with pairwise Cohen’s Kappa values.
- ‘average_pairwise’: A dictionary with the average pairwise Kappa for each rater.
- ‘fleiss’: The Fleiss’ Kappa value for the overall agreement across all raters.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.krippendorff_alpha_adata">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">krippendorff_alpha_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_of_measurement</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nominal'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#krippendorff_alpha_adata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.krippendorff_alpha_adata" title="Link to this definition"></a></dt>
<dd><p>Calculate Krippendorff’s Alpha for categorical data in adata.obs[cols].
Parameters:
- adata: AnnData object.
- cols: List of columns in adata.obs to use for calculating agreement.
- level_of_measurement: The type of data (‘nominal’, ‘ordinal’, ‘interval’, ‘ratio’). Default is ‘nominal’ (for categorical data).
Returns:
- Krippendorff’s Alpha for the specified columns in adata.obs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.stablelabel.harmony_label_transfer">
<span class="sig-prename descclassname"><span class="pre">anndict.stablelabel.</span></span><span class="sig-name descname"><span class="pre">harmony_label_transfer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_to_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master_subset_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_column</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/stablelabel.html#harmony_label_transfer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.stablelabel.harmony_label_transfer" title="Link to this definition"></a></dt>
<dd><p>Perform Harmony integration and transfer labels from master_data to adata_to_label.</p>
<p>This function subsets master_data based on a provided column to get the cells
that match in the same column of adata_to_label. It then performs Harmony
integration on the combined dataset and transfers the specified label column
from master_data to adata_to_label.</p>
<p>Parameters:
adata_to_label : anndata.AnnData The AnnData object to which labels will be transferred.
master_data : anndata.AnnData The master AnnData object containing the reference data and labels.
master_subset_column : str The column name in .obs used for subsetting master_data to match adata_to_label.
label_column : str The column name in .obs of master_data containing the labels to be transferred.</p>
<p>Returns:
anndata.AnnData The adata_to_label object with a new column ‘harmony_labels’ in .obs containing the transferred labels.</p>
</dd></dl>

<dl class="py function" id="module-anndict.spatial_dict">
<dt class="sig sig-object py" id="anndict.spatial_dict.read_data">
<span class="sig-prename descclassname"><span class="pre">anndict.spatial_dict.</span></span><span class="sig-name descname"><span class="pre">read_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">platform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/spatial_dict.html#read_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.spatial_dict.read_data" title="Link to this definition"></a></dt>
<dd><p>Reads the data from a CSV file and ensures it contains the necessary columns.</p>
<p>Parameters:
file_path (str): The path to the CSV file.
platform (str): The platform type (“Merscope” or “Xenium”).</p>
<p>Returns:
pd.DataFrame: The data read from the file.</p>
<p>Raises:
ValueError: If the required columns are not present in the file or if the file format is unsupported.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.spatial_dict.get_steps_and_coords">
<span class="sig-prename descclassname"><span class="pre">anndict.spatial_dict.</span></span><span class="sig-name descname"><span class="pre">get_steps_and_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/spatial_dict.html#get_steps_and_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.spatial_dict.get_steps_and_coords" title="Link to this definition"></a></dt>
<dd><p>Computes the number of steps and the top-left coordinates of each box.</p>
<p>Parameters:
df (pd.DataFrame): The data containing ‘global_x’ and ‘global_y’ columns.
box_size (int): The size of the box.
step_size (int): The step size.</p>
<p>Returns:
tuple: A tuple containing the number of steps in x and y directions, and the list of top-left coordinates of each box.</p>
<p>Raises:
ValueError: If the box size is larger than the image dimensions.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.spatial_dict.populate_sparse_array">
<span class="sig-prename descclassname"><span class="pre">anndict.spatial_dict.</span></span><span class="sig-name descname"><span class="pre">populate_sparse_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords_top_left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/spatial_dict.html#populate_sparse_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.spatial_dict.populate_sparse_array" title="Link to this definition"></a></dt>
<dd><p>Populates a sparse array with gene counts.</p>
<p>Parameters:
df (pd.DataFrame): The data containing ‘global_x’, ‘global_y’, and ‘gene’ columns.
coords_top_left (list): The list of top-left coordinates of each box.
genes (np.array): The unique genes.
step_size (int): The step size.</p>
<p>Returns:
scipy.sparse.csr_matrix: The sparse matrix with gene counts.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.spatial_dict.process_gene_counts">
<span class="sig-prename descclassname"><span class="pre">anndict.spatial_dict.</span></span><span class="sig-name descname"><span class="pre">process_gene_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">platform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/spatial_dict.html#process_gene_counts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.spatial_dict.process_gene_counts" title="Link to this definition"></a></dt>
<dd><p>Processes the gene counts from the CSV file.</p>
<p>Parameters:
file_path (str): The path to the CSV file.
box_size (int): The size of the box.
step_size (int): The step size.</p>
<p>Returns:
tuple: A tuple containing the sparse matrix, unique genes, and list of top-left coordinates of each box.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.spatial_dict.create_anndata">
<span class="sig-prename descclassname"><span class="pre">anndict.spatial_dict.</span></span><span class="sig-name descname"><span class="pre">create_anndata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sparse_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords_top_left</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/spatial_dict.html#create_anndata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.spatial_dict.create_anndata" title="Link to this definition"></a></dt>
<dd><p>Creates an AnnData object from the sparse matrix and coordinates.</p>
<p>Parameters:
sparse_array (scipy.sparse.csr_matrix): The sparse matrix with gene counts.
genes (np.array): The unique genes.
coords_top_left (list): The list of top-left coordinates of each box.</p>
<p>Returns:
anndata.AnnData: The AnnData object containing the gene counts and metadata.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.spatial_dict.add_blank_image_to_adata">
<span class="sig-prename descclassname"><span class="pre">anndict.spatial_dict.</span></span><span class="sig-name descname"><span class="pre">add_blank_image_to_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">platform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Merscope'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/spatial_dict.html#add_blank_image_to_adata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.spatial_dict.add_blank_image_to_adata" title="Link to this definition"></a></dt>
<dd><p>Adds a dummy image to the AnnData object based on the platform specifications.</p>
<p>Parameters:
adata (anndata.AnnData): The AnnData object to which the image will be added.
platform (str): The platform from which the data originates. Default is “Merscope”.</p>
<p>Returns:
anndata.AnnData: The updated AnnData object with the image and spatial data.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.spatial_dict.build_adata_from_transcript_positions">
<span class="sig-prename descclassname"><span class="pre">anndict.spatial_dict.</span></span><span class="sig-name descname"><span class="pre">build_adata_from_transcript_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">platform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Merscope'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/spatial_dict.html#build_adata_from_transcript_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.spatial_dict.build_adata_from_transcript_positions" title="Link to this definition"></a></dt>
<dd><p>Builds an AnnData object from a detected_trancsripts.csv (Merscope) or transcripts.csv (Xenium) file and saves it to a specified output path. These are the files output by most spatial transcriptomic platforms, including Visium, Visium HD, Xenium, and Merscope.</p>
<p>Parameters:
paths_dict (dict): A dictionary with input paths as keys and output paths as values.
box_size (int, optional): The size of the box. Default is 16.
step_size (int, optional): The step size. Default is 16.
platform (str, optional): The platform used, either “Merscope” (default) or “Xenium”.</p>
<p>Returns:
None</p>
<section id="example">
<h2>Example:<a class="headerlink" href="#example" title="Link to this heading"></a></h2>
<dl>
<dt>paths_dict = {</dt><dd><p>‘input_path1.csv’: ‘output_path1.h5ad’,</p>
<p>‘input_path2.csv’: ‘output_path2.h5ad’</p>
<p># Add more input-output path pairs as needed</p>
<p>}</p>
</dd>
</dl>
<p>build_adata_from_transcript_positions(paths_dict)</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.spatial_dict.build_adata_from_visium">
<span class="sig-prename descclassname"><span class="pre">anndict.spatial_dict.</span></span><span class="sig-name descname"><span class="pre">build_adata_from_visium</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/spatial_dict.html#build_adata_from_visium"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.spatial_dict.build_adata_from_visium" title="Link to this definition"></a></dt>
<dd><p>Processes Visium data from input directories and saves the processed AnnData objects to specified output paths.</p>
<p>Parameters:
paths_dict (dict): A dictionary with input directories as keys and output file paths as values.
hd (bool, optional): If True, converts ‘spatial’ to float and ‘obs’ columns to integers. Default is False.</p>
<p>Returns:
None</p>
<section id="id2">
<h2>Example:<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<dl>
<dt>paths_dict = {</dt><dd><p>‘input_dir1’: ‘output_path1.h5ad’,</p>
<p>‘input_dir2’: ‘output_path2.h5ad’</p>
<p># Add more input-output path pairs as needed</p>
<p>}</p>
</dd>
</dl>
<p>build_adata_from_visium(paths_dict, hd=True)</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.spatial_dict.plot_spatial_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.spatial_dict.</span></span><span class="sig-name descname"><span class="pre">plot_spatial_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/spatial_dict.html#plot_spatial_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.spatial_dict.plot_spatial_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Plots spatial data for each AnnData object in adata_dict, colored by a specified variable.</p>
<p>Parameters:
- adata_dict (dict): A dictionary with keys as strata and values as AnnData objects.
- kwargs: Additional keyword arguments, including ‘color_by’ which specifies a variable by which to color the spatial plots, typically a column in .obs, and ‘crop_coord’ which specifies coordinates for cropping the spatial plots.</p>
<p>Returns:
- None: The function creates spatial plots for the AnnData objects.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.spatial_dict.compute_spatial_neighbors_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.spatial_dict.</span></span><span class="sig-name descname"><span class="pre">compute_spatial_neighbors_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/spatial_dict.html#compute_spatial_neighbors_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.spatial_dict.compute_spatial_neighbors_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Computes spatial neighborhood graphs for each AnnData object in adata_dict.</p>
<p>Parameters:
adata_dict (dict): A dictionary with keys as strata and values as AnnData objects.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.spatial_dict.perform_colocalization_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.spatial_dict.</span></span><span class="sig-name descname"><span class="pre">perform_colocalization_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cell_type'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/spatial_dict.html#perform_colocalization_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.spatial_dict.perform_colocalization_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Performs colocalization analysis for each AnnData object in adata_dict.</p>
<p>Parameters:
adata_dict (dict): A dictionary with keys as strata and values as AnnData objects.
cluster_key (str): The key in adata.obs containing the cell type or cluster information.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.spatial_dict.plot_colocalization_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.spatial_dict.</span></span><span class="sig-name descname"><span class="pre">plot_colocalization_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cell_type'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_cell_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/spatial_dict.html#plot_colocalization_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.spatial_dict.plot_colocalization_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Plots colocalization results for each AnnData object in adata_dict, optionally focusing on a specific source cell type.</p>
<p>Parameters:
adata_dict (dict): A dictionary with keys as strata and values as AnnData objects.
cluster_key (str): The key in adata.obs containing the cell type or cluster information.
source_cell_type (str, optional): The specific source cell type to focus on in the colocalization plot.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.spatial_dict.compute_interaction_matrix_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.spatial_dict.</span></span><span class="sig-name descname"><span class="pre">compute_interaction_matrix_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cell_type'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/spatial_dict.html#compute_interaction_matrix_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.spatial_dict.compute_interaction_matrix_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Computes interaction matrices for each AnnData object in adata_dict.</p>
<p>Parameters:
adata_dict (dict): A dictionary with keys as strata and values as AnnData objects.
cluster_key (str): The key in adata.obs containing the cell type or cluster information.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="anndict.spatial_dict.plot_interaction_matrix_adata_dict">
<span class="sig-prename descclassname"><span class="pre">anndict.spatial_dict.</span></span><span class="sig-name descname"><span class="pre">plot_interaction_matrix_adata_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cell_type'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/anndict/spatial_dict.html#plot_interaction_matrix_adata_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#anndict.spatial_dict.plot_interaction_matrix_adata_dict" title="Link to this definition"></a></dt>
<dd><p>Plots interaction matrices for each AnnData object in adata_dict.</p>
<p>Parameters:
adata_dict (dict): A dictionary with keys as strata and values as AnnData objects.
cluster_key (str): The key in adata.obs containing the cell type or cluster information.</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to AnnDictionary’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, ggit12.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>